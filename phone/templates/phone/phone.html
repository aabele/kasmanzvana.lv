{% extends "phone/base.html" %}
{% load extra_tags %}

{% block page_title %}{{ COUNTRY_PREFIX }} {{ number }}{% endblock %}

{% block page_description %}{{ object.visible_comments.0.body|striptags }}{% endblock %}

{% block extra_head %}
    <script>

        "use strict";

        var phone = {
            "id": "{{ number }}"
        };

    </script>
{% endblock %}

{% block body-header %}
    <div class="jumbotron text-center" id="front-jumbo">
        <h1>
            <a href="{{ request.path }}" title="{{ number }}">
                {{ COUNTRY_PREFIX }} {{ number }}
            </a>
        </h1>
        <p>Zvana no šī nepazīstamā numura?</p>
    </div>
{% endblock %}
{% block body %}

    {% include "phone/_snippets/login-block.html" %}

    <div class="row">
        <div class="col-md-12 {% if request.user.is_authenticated %}padding4{% endif %}">

            <div class="row">
                <div class="col-md-12">
                    <h1>
                        <i class="fa fa-comments" aria-hidden="true"></i>
                        Apmeklētāju komentāri
                    </h1>
                    <hr>
                    {% if object.visible_comments %}
                         <div class="padding1">
                            {% for comment in object.visible_comments %}
                                {% if not forloop.first %}<hr>{% endif %}
                                <div>
                                    <div class="lead">
                                        {% if comment.is_admin %}
                                            {{ comment.body|safe|linebreaks }}
                                        {% else %}
                                            {{ comment.body|linebreaks }}
                                        {% endif %}
                                    </div>

                                    <div class="meta">
                                        <i class="fa fa-user" aria-hidden="true"></i> {% include "phone/_snippets/user.html" with user=comment.author %} @
                                        {{ comment.insert_date }}
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p>Pagaidām vēl nav informācijas.</p>
                    {% endif %}
                </div>
            </div>


            <form method="post" action="{% url "phones:add_comment" %}" class="" id="comment-form" style="display: none">

                <div class="padding0-1">
                    <h1>
                        <i class="fa fa-commenting" aria-hidden="true"></i>
                        Tev ir zināms kas ir šis par numuru?
                    </h1>
                </div>

                {% csrf_token %}

                <input type="hidden" name="phone" value="{{ number }}">

                <div class="form-group{% if form.body.errors %} has-error{% endif %}">
                    <label for="{{ form.body.auto_id }}" style="display: none">Komentārs</label>
                    {{ form.body }}
                    {% if form.body.errors %}
                        <span id="error-{{ form.body.auto_id }}" class="help-block">
                            {% for error in form.body.errors %}
                                {{ error }}
                            {% endfor %}
                        </span>
                    {% endif %}
                </div>

                <button type="submit" class="btn btn-primary" id="comment-form-submit">
                    Saglabāt
                </button>

            </form>
        </div>
    {% include "phone/breadcrumbs.html" %}
    </div>



{% endblock %}
{% block sidebar %}{% include "phone/_snippets/phone-sidebar.html" %}{% endblock %}
